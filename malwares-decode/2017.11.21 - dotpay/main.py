#!/usr/bin/env python3

import sys
import base64

if len(sys.argv) > 1:
    # get filename from command line
    filename = sys.argv[1]

    # read file as "pure" Unicode, not utf-8 nor utf-16 nor ascii
    print('\n--- wczytane z plik (jako Unicode) ---\n')
    data = open(filename, encoding='unicode_escape').read()
    print(data,)
    
    # find string to endcode
    print('\n--- wycinek po "-EncodedCommand" ---\n')
    start = data.find('-EncodedCommand ') + len('-EncodedCommand ')
    end   = data.find('=', start) + 1
    data = data[start:end]
    print(data)
    
    # decode base64 and decode utf-16 into Unicode
    print('\n--- decode base64 i utf16 ---\n')
    data = base64.b64decode(data)
    data = data.decode('utf16')
    print(data)
